INPUT start BIT
OUTPUT done BIT
OUTPUT error BIT
INPUT Xin BITVECTOR 16
INPUT Yin BITVECTOR 16
OUTPUT Zout BITVECTOR 16
INPUT done_m BIT
OUTPUT start_m BIT
OUTPUT Xout BITVECTOR 16
OUTPUT Yout BITVECTOR 16
INPUT Zin BITVECTOR 16
VARIABLE X BITVECTOR 16
VARIABLE Y BITVECTOR 16
WAIT1 start
ASSIGN X Xin
ASSIGN Y Yin
NE X0 Xin 0
NE Y0 Yin 0
AND c1 X0 Y0
IF if1 c1
LT less X Y
IF if2 less
ASSIGN tmp X
ASSIGN X Y
ASSIGN Y tmp
ENDIF if2
LOOP loop1
WAIT0 done_m
ASSIGN Xout X
ASSIGN Yout Y
ASSIGN start_m '1'
WAIT1 done_m
EQ Z0 Zin 0
EXIT loop1 Z0
ASSIGN X Y
ASSIGN Y Zin
ASSIGN start_m '0'
ENDLOOP loop1
ASSIGN Zout X
ASSIGN done '1'
ASSIGN error '0'
ELSE if1
ASSIGN done '1'
ASSIGN error '1'
ENDIF if1
WAIT0 start
ASSIGN done '0'
END